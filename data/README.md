# Data Storage Structure

This directory contains all data collected and generated by the AItrade trading system. The structure is organized to separate different types of data for easy management, analysis, and maintenance.

## üìÅ Directory Structure

```
data/
‚îú‚îÄ‚îÄ market_data/           # Raw and processed market data
‚îú‚îÄ‚îÄ trading_logs/          # All trading execution logs
‚îú‚îÄ‚îÄ strategy_states/       # Strategy state persistence
‚îú‚îÄ‚îÄ ai_reports/           # AI-generated analysis reports
‚îú‚îÄ‚îÄ system_logs/          # System operation logs
‚îú‚îÄ‚îÄ backtest_results/     # Historical backtesting results
‚îú‚îÄ‚îÄ performance_metrics/  # Trading performance analytics
‚îî‚îÄ‚îÄ real_time_feeds/      # Live data feed storage
```

## üìä Market Data (`market_data/`)

### `historical/`
- **Purpose**: Historical price data for backtesting and analysis
- **Format**: CSV files with OHLCV data
- **Naming**: `{SYMBOL}_{START_DATE}_{END_DATE}.csv`
- **Sources**: IBKR, Alpaca, Yahoo Finance
- **Example**: `NVDA_2024-01-01_2024-12-31.csv`

### `real_time/`
- **Purpose**: Real-time quote and trade data
- **Format**: Timestamped CSV files
- **Naming**: `{SYMBOL}_{DATE}_{SESSION}.csv`
- **Sessions**: regular, pre_market, after_hours, overnight
- **Example**: `AAPL_2025-01-15_regular.csv`

### `options_chain/`
- **Purpose**: Options pricing and Greeks data
- **Format**: JSON and CSV files
- **Naming**: `{SYMBOL}_options_{EXPIRY}_{DATE}.json`
- **Contains**: Strike prices, premiums, Greeks, volume
- **Example**: `NVDA_options_2025-02-21_2025-01-15.json`

### `fundamentals/`
- **Purpose**: Company fundamental data
- **Format**: JSON files
- **Naming**: `{SYMBOL}_fundamentals_{DATE}.json`
- **Sources**: FinnHub, Yahoo Finance
- **Example**: `AAPL_fundamentals_2025-01-15.json`

## üìù Trading Logs (`trading_logs/`)

### `quantitative/`
- **Purpose**: Quantitative strategy execution logs
- **Files**:
  - `quant_main_{DATE}.log` - Main quantitative system logs
  - `integrated_trading_{DATE}.log` - Integrated MACD trader logs
  - `strategy_execution_{STRATEGY}_{DATE}.log` - Strategy-specific logs

### `ai_agents/`
- **Purpose**: AI agent system logs
- **Files**:
  - `trading_agents_{DATE}.log` - Multi-agent system logs
  - `agent_decisions_{DATE}.log` - Agent decision processes
  - `research_debates_{DATE}.log` - Bull/bear research debates

### `broker_specific/`
- **`ibkr/`**: Interactive Brokers TWS API logs
- **`alpaca/`**: Alpaca API execution logs  
- **`legacy/`**: Legacy Alpaca system logs

### `error_logs/`
- **Purpose**: System errors and exceptions
- **Files**:
  - `errors_{DATE}.log` - General error logs
  - `connection_errors_{DATE}.log` - Broker connection issues
  - `data_errors_{DATE}.log` - Data retrieval issues

## üéØ Strategy States (`strategy_states/`)

### `macd/`
- **Purpose**: MACD strategy state persistence
- **Format**: JSON files
- **Naming**: `{SYMBOL}_macd_state_{DATE}.json`
- **Contains**: Position type, shares, last action, signal time

### `moving_average/`
- **Purpose**: Moving Average Crossover strategy states
- **Format**: JSON files with MA parameters and positions

### `rsi/`
- **Purpose**: RSI strategy states
- **Format**: JSON files with RSI levels and position info

### `bollinger_bands/`
- **Purpose**: Bollinger Bands strategy states
- **Format**: JSON files with band levels and trades

### `options/`
- **Purpose**: Options trading strategy states
- **Format**: JSON files with Greeks, positions, and risk metrics

## ü§ñ AI Reports (`ai_reports/`)

### `daily_analysis/`
- **Purpose**: Daily market analysis from AI agents
- **Format**: Markdown and JSON files
- **Naming**: `{SYMBOL}_analysis_{DATE}.md`
- **Contains**: Fundamental, technical, sentiment analysis

### `strategy_recommendations/`
- **Purpose**: AI-generated strategy recommendations
- **Format**: JSON files with confidence scores
- **Naming**: `{SYMBOL}_recommendations_{DATE}.json`

### `risk_assessments/`
- **Purpose**: Portfolio and position risk evaluations
- **Format**: JSON and PDF reports
- **Naming**: `risk_assessment_{DATE}.json`

### `market_sentiment/`
- **Purpose**: Market sentiment analysis from multiple sources
- **Format**: JSON files with sentiment scores
- **Naming**: `sentiment_{DATE}.json`

## üìà Performance Metrics (`performance_metrics/`)

### `daily/`
- **Purpose**: Daily trading performance summaries
- **Format**: CSV files with P&L, trades, returns
- **Naming**: `performance_{DATE}.csv`

### `weekly/` / `monthly/` / `yearly/`
- **Purpose**: Aggregated performance metrics
- **Format**: CSV and JSON summary files
- **Contains**: Total returns, Sharpe ratio, max drawdown

## üî¨ Backtest Results (`backtest_results/`)

### `by_strategy/`
- **Purpose**: Strategy-specific backtest results
- **Naming**: `{STRATEGY}_backtest_{START}_{END}.json`
- **Contains**: Strategy parameters, performance metrics, trade log

### `by_symbol/`
- **Purpose**: Symbol-specific backtest results
- **Naming**: `{SYMBOL}_backtest_{STRATEGY}_{PERIOD}.json`

### `by_timeframe/`
- **Purpose**: Timeframe-specific analysis
- **Naming**: `{TIMEFRAME}_analysis_{STRATEGY}_{DATE}.json`

## üì° Real-time Feeds (`real_time_feeds/`)

- **Purpose**: Live data feed storage and buffering
- **Format**: Binary and CSV files
- **Contains**: WebSocket streams, quote feeds, trade feeds
- **Rotation**: Hourly rotation with compression

## üîß Data Management

### Automatic Cleanup
- **Historical data**: Kept for 2 years
- **Logs**: Kept for 6 months, compressed after 1 month
- **Real-time feeds**: Kept for 1 week
- **AI reports**: Kept for 1 year
- **Performance metrics**: Kept permanently

### File Naming Conventions
- **Dates**: ISO format `YYYY-MM-DD`
- **Times**: 24-hour format `HHMMSS`
- **Symbols**: Uppercase ticker symbols
- **Extensions**: `.csv` for data, `.json` for structured data, `.log` for logs

### Compression
- **Logs**: Gzip compression after 30 days
- **Historical data**: LZ4 compression for large files
- **Backtest results**: JSON compression for storage efficiency

## üöÄ Usage Examples

### Accessing Historical Data
```python
import pandas as pd

# Load historical data
data = pd.read_csv('data/market_data/historical/NVDA_2024-01-01_2024-12-31.csv')

# Load strategy state
import json
with open('data/strategy_states/macd/NVDA_macd_state_2025-01-15.json') as f:
    state = json.load(f)
```

### Performance Analysis
```python
# Load daily performance
perf = pd.read_csv('data/performance_metrics/daily/performance_2025-01-15.csv')

# Calculate monthly returns
monthly = perf.groupby(pd.Grouper(key='date', freq='M')).sum()
```

## üîí Data Security

- **Sensitive data**: API keys and credentials are NOT stored in data files
- **Encryption**: Personal trading data encrypted at rest
- **Backup**: Daily automated backups to secure location
- **Access control**: File permissions restrict access to trading system user

## üìã Maintenance Schedule

- **Daily**: Cleanup temporary files, rotate logs
- **Weekly**: Compress old logs, backup critical data
- **Monthly**: Performance analysis, data integrity checks
- **Quarterly**: Archive old data, update retention policies

---

**Note**: This data structure is designed to support both the quantitative trading system and AI agent framework, ensuring comprehensive data collection for analysis, compliance, and system optimization.